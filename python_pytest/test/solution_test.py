from typing import *
import math

class Solution:
    def smallestDivisor(self, nums: List[int], threshold: int) -> int:
        """
        Contest 166
        1283. Find the Smallest Divisor Given a Threshold
        https://leetcode.com/contest/weekly-contest-166/problems/find-the-smallest-divisor-given-a-threshold/
        """
        def div(a, b):
            return math.ceil(a / b)

        def val(nums, divisor):
            return sum([div(n, divisor) for n in nums])

        l = 1
        h = max(nums)
        while True:
            d = int((l + h) / 2)
            m = val(nums, d)
            #print(f"{l=}, {h=}, {d=}, {m=}, {threshold=}")
            if m == threshold:
                break
            if h - l <= 1:
                break
            if m > threshold:
                l = d
            else:
                h = d

        while True:
            if val(nums, d) > threshold:
                if val(nums, d + 1) <= threshold:
                    return d + 1
                else:
                    d += 1
            if val(nums, d) <= threshold:
                if d == 1:
                    return d
                if val(nums, d - 1) > threshold:
                    return d
                else:
                    d -= 1


    def minFlips(self, mat: List[List[int]]) -> int:
        """
        Contest 166
        1284. Minimum Number of Flips to Convert Binary Matrix to Zero Matrix
        https://leetcode.com/contest/weekly-contest-166/problems/minimum-number-of-flips-to-convert-binary-matrix-to-zero-matrix/
        """
        def flip(mat, row, col):
            def flipCell(mat, row, col):
                if 0 <= row < m and 0 <= col < n:
                    mask = 1 << (row * n + col)
                    if mat & mask == 0:
                        mat |= mask
                    else:
                        mat &= (~mask)
                return mat
            flipped = mat
            flipped = flipCell(flipped, row, col)
            flipped = flipCell(flipped, row - 1, col)
            flipped = flipCell(flipped, row, col - 1)
            flipped = flipCell(flipped, row + 1, col)
            flipped = flipCell(flipped, row, col + 1)
            return flipped

        def toKey(mat):
            return int(''.join([''.join([str(n) for n in r]) for r in mat]), 2)

        def isZero(mat):
            return mat == 0

        m = len(mat)
        n = len(mat[0])
        mat_int = toKey(mat)
        to_cover: List[Tuple(int, int)] = [ (mat_int, 0) ]
        covered: Set[int] = set()

        while to_cover:
            to_cover_new = []
            for mat_step, step_count in to_cover:
                covered.add(mat_step)
                if isZero(mat_step):
                    # print(f"Zero!! {mat_step=}")
                    return step_count

                for r in range(m):
                    for c in range(n):
                        flipped = flip(mat_step, r, c)
                        # print(bin(flipped), r, c, bin(mat_step))
                        if flipped not in covered:
                            to_cover_new.append((flipped, step_count + 1))

            to_cover = to_cover_new
            # print(to_cover, covered)

        return -1

    def twoSum(self, nums: List[int], target: int) -> List[int]:
        """
        1. Two Sum
        https://leetcode.com/problems/two-sum/
        """
        num_map: Map[int, int] = {}
        for i, n in enumerate(nums):
            if n not in num_map:
                num_map[n] = []
            num_map[n].append(i)
        for n in num_map:
            if (target - n) in num_map:
                if n == target - n:
                    if len(num_map[n]) < 2:
                        continue
                    return num_map[n]
                return sorted([num_map[n][0], num_map[target - n][0]])

    def findSpecialInteger(self, arr: List[int]) -> int:
        max_count = 0
        max_value = None
        m = dict()
        for n in arr:
            if n not in m:
                m[n] = 0
            m[n] += 1
            if m[n] > max_count:
                max_count = m[n]
                max_value = n

        return max_value

    def removeCoveredIntervals(self, intervals: List[List[int]]) -> int:
        ranges = sorted(intervals, key=lambda i: i[0])
        to_remove = set()
        for i, (a, b) in enumerate(ranges):
            j = i + 1
            while True:
                if len(ranges) <= j:
                    break
                if b <= ranges[j][0]:
                    break
                # print(ranges, to_remove)
                if a <= ranges[j][0] and ranges[j][1] <= b:
                    to_remove.add(tuple(ranges[j]))
                j += 1

        return len(ranges) - len(to_remove)


class CombinationIterator:

    def __init__(self, characters: str, combinationLength: int):
        self.characters = characters
        self.combinationLength = combinationLength
        self.stop = False
        self.picking = list(range(combinationLength))

    def next(self) -> str:
        if self.stop:
            raise StopIteration()
        print(self.picking)
        s = ''.join([self.characters[i] for i in self.picking])
        self.increment()
        return s

    def hasNext(self) -> bool:
        return not self.stop

    def increment(self):
        idx = len(self.picking) - 1
        while True:
            self.picking[idx] += 1
            if self.picking[idx] >= len(self.characters) - (len(self.picking) - idx - 1):
                if idx == 0:
                    self.stop = True
                    return
                self.picking[idx] = -1
                idx -= 1
            else:
                for i in range(idx + 1, len(self.picking)):
                    self.picking[i] = self.picking[i - 1] + 1
                break


import pytest

@pytest.fixture
def sut():
    return Solution()

@pytest.mark.skip
@pytest.mark.parametrize('nums,threshold,answer', [
        ([1,2,5,9], 6, 5),
        ([16,79,6,43,53], 172, 2)
    ])
def test_smallestDivisor(sut, nums, threshold, answer):
    assert answer == sut.smallestDivisor(nums, threshold)


@pytest.mark.skip
@pytest.mark.parametrize('mat,answer', [
        ([[0,0],[0,1]], 3),
        ([[0]], 0),
        ([[1,1,1],[1,0,1],[0,0,0]], 6),
        ([[1,0,0],[1,0,0]], -1),
        ([[1,1,1],[1,1,1],[0,0,0]], 7),
    ])
def test_minFlips(sut, mat, answer):
    assert answer == sut.minFlips(mat)


@pytest.mark.skip
@pytest.mark.parametrize('nums, target, answer', [
        ([2,7,11,15], 9, [0, 1]),
        ([0, 4, 3, 0], 0, [0, 3]),
        ([-3,4,3,90], 0, [0, 2]),
        ([3,2,4], 6, [1, 2]),

    ])
def test_twoSum(sut, nums, target, answer):
    assert answer == sut.twoSum(nums, target)


@pytest.mark.skip
@pytest.mark.parametrize('arr, answer', [
        ([1,2,2,6,6,6,6,7,10], 6),
    ])
def test_findSpecialInteger(sut, arr, answer):
    assert answer == sut.findSpecialInteger(arr)


@pytest.mark.skip
@pytest.mark.parametrize('intervals, answer', [
        ([[1,4],[3,6],[2,8]], 2),
        ([[1,4],[2,3]], 1),
        ([[34335,39239],[15875,91969],[29673,66453],[53548,69161],[40618,93111]], 2),
        ([[90830,93237],[10589,24944],[8364,19281],[13032,23453],[54845,57796],[14919,57271],[44661,67492],[19062,31471],[10952,33453],[12830,30475],[48218,94202],[10437,49360],[56672,68654],[14280,81936],[16647,52382],[52675,80051],[1050,7075],[45194,97542],[24522,46060],[13797,39454],[57978,75685],[25755,71906],[57920,94764],[56160,97713],[3452,76942],[5756,55287],[9552,25347],[6092,64406],[72188,73050],[9645,20611],[10754,74812],[21558,46131],[1812,52266],[23993,53744],[72448,75345],[30414,44232],[46520,93309],[23305,99419],[1883,43934],[44621,64192],[6246,51738],[43701,57667],[48866,73214],[7589,67869],[59513,69567],[38353,90269],[28343,79956],[13408,93049],[64617,73266],[48300,68447],[5542,74143],[16086,90751],[82644,96381],[10429,11982],[10220,12158],[21738,39004],[62222,85030],[14935,86562],[22500,94683],[44231,52218],[54312,80215],[44510,45663],[58938,61964],[30843,32018],[35705,38855],[30851,67298],[42074,60580],[26601,81287],[41477,50610],[5373,14311],[48836,51999],[26169,65028],[52143,71758],[39994,90727],[50391,54148],[1927,63944],[28436,95369],[41294,54365],[18475,35259],[80915,92174],[28625,91996],[2694,10310],[10096,88795],[81044,86141],[35814,45662],[37226,62105],[90522,91990],[38589,70551],[53806,82402],[12958,93011],[16058,43556],[37131,89050],[25592,62759],[70999,73709],[6073,14298],[72658,98669],[17964,47733],[17610,76572],[6790,48625],[32653,38574],[28460,70444],[41119,57578],[51491,64949],[17745,59681],[66017,98625],[25065,98086],[61525,99536],[14665,33153],[8028,20879],[68293,71235],[36364,65298],[17292,90446],[61007,69685],[4831,91239],[67298,85222],[61693,82301],[36446,43608],[90227,92945],[18449,56741],[2805,39468],[39886,53836],[50841,76095],[85911,94451],[13578,77650],[81207,81689],[28514,99213],[38330,38451],[6247,93412],[83204,88261],[10188,63571],[10513,39403],[5052,58644],[71346,75221],[38671,86319],[83455,85510],[11320,82962],[43665,88371],[50467,70945],[17097,79802],[29356,98438],[51560,99980],[26851,28799],[53515,77753],[38059,67549],[20724,71045],[23211,99453],[75952,96661],[39955,85361],[3112,5884],[11372,64187],[39924,57195],[3658,89266],[26794,29889],[6604,29253],[48100,75030],[86542,94180],[35178,51727],[18565,30794],[56104,58210],[27533,97500],[16132,35878],[14299,24307],[1470,27510],[12879,28452],[30301,63267],[17500,25456],[23998,59350],[23112,62280],[74268,88790],[35627,41852],[17130,95875],[8950,91569],[8078,29454],[13424,50075],[31343,90278],[19369,20288],[15174,90245],[1368,7104],[25523,43374],[1161,70372],[87296,93158],[31611,90305],[37028,60599],[907,69036],[2511,58749],[2995,85124],[30571,98490],[2017,63871],[44690,57215],[12740,62137],[34227,70010],[24611,67081],[54856,82017],[41029,41847],[18154,34540],[25519,61845],[14513,21020],[70559,75290],[73206,88113],[85426,94453],[69560,93108],[5032,41704],[4232,17403],[13692,25646],[32281,38634],[41195,62740],[7672,75331],[12946,83556],[13523,49634],[79190,80396],[5864,87915],[30260,56708],[18199,50684],[29431,51901],[56838,86314],[5122,24336],[25372,76462],[79248,87273],[3218,83864],[78786,89025],[31421,49214],[14079,87730],[6687,68102],[37707,74192],[41027,92079],[7850,91768],[10512,76292],[18881,30776],[44808,51557],[39757,69474],[19051,47688],[65863,78190],[42935,96532],[63850,87942],[4576,40954],[33648,89544],[15305,67811],[64285,99114],[45584,86272],[62874,84452],[28727,31255],[42911,94961],[6030,15089],[79906,93057],[58879,98239],[6608,52487],[47462,92420],[86478,91819],[34238,78237],[97024,99226],[16388,99255],[18846,29081],[40338,50663],[13001,16007],[16009,33942],[16012,51970],[79466,86691],[17944,58273],[81559,84259],[19805,79491],[6343,13809],[2772,3635],[13973,86980],[3132,51187],[15227,57939],[95921,97063],[17214,51575],[46722,91114],[21582,84169],[11352,95253],[26280,40308],[64285,99546],[35518,73458],[32685,57974],[17308,60077],[40128,53614],[35279,48722],[61058,99281],[1481,93184],[4151,11920],[54579,65438],[47219,80764],[17772,26752],[29226,66540],[78069,88725],[51189,70745],[30634,52885],[31330,74109],[51949,78290],[66807,76300],[25866,97232],[26353,57785],[50136,88163],[47576,77214],[67073,86724],[26550,73101],[50636,97131],[1988,22494],[7508,99863],[6132,93055],[62272,84543],[11775,71101],[33422,79056],[47026,66667],[1960,45364],[41656,78235],[80428,88065],[17760,68054],[8061,23136],[76584,83587],[1188,1603],[72815,85842],[24098,67316],[58122,76154],[82749,93571],[46068,65239],[5237,79145],[15241,84681],[63562,81877],[32562,50425],[85888,88892],[14947,36547],[25763,38120],[46920,80763],[6337,80937],[12617,38481],[76836,77465],[41268,54752],[10254,67869],[18496,70622],[31830,68556],[23078,62010],[5480,89302],[25454,29509],[45312,70879],[71964,98914],[50901,95802],[40300,43953],[30879,44718],[7962,41359],[18649,74044],[58078,89903],[37457,92670],[34940,71520],[12658,72338],[59988,69650],[68292,86531],[11499,94284],[38013,80237],[2206,97653],[73039,93362],[7301,87990],[6892,47572],[64469,64807],[56808,76175],[16693,24050],[15742,51274],[23193,58114],[38090,62420],[42261,57601],[4601,73027],[5942,64634],[17626,84937],[15301,94352],[40414,77672],[25024,25093],[34320,63978],[87906,94699],[11568,82288],[66239,80235],[26105,30510],[10797,97455],[23001,46174],[72259,81362],[35648,83302],[57106,93581],[19574,64498],[45438,67644],[37047,39250],[47042,69678],[52492,68522],[43491,75363],[4650,69692],[32580,58335],[75278,91228],[47608,66335],[62457,91812],[30330,80242],[623,2825],[34920,72055],[1745,62966],[9815,25871],[23844,28922],[59079,96077],[89818,94052],[7256,61662],[53231,63022],[76789,87757],[64959,74504],[44815,72354],[47217,61880],[20604,84738],[55261,75867],[13318,52208],[7257,10068],[72239,77527],[71295,87305],[43158,82010],[50919,88994],[36570,55617],[85494,92793],[48313,82558],[32493,72856],[46278,67564],[48836,64829],[42464,98812],[14733,43237],[27214,47264],[24942,26922],[29743,76006],[56252,66036],[46688,89663],[6220,84342],[42568,92178],[22407,72751],[8682,24250],[9203,66920],[19190,53152],[1051,4405],[9306,89282],[20934,92444],[83278,94059],[32806,37351],[41556,64171],[38614,51110],[36808,65256],[12157,84241],[5057,74569],[45279,81836],[3393,38591],[22483,62075],[15373,62188],[57884,92358],[13947,70873],[25246,88523],[34428,82548],[65744,78448],[17847,34461],[80741,86602],[39739,92630],[7232,44817],[4617,47207],[4950,18438],[2143,58719],[10489,33137],[52794,86285],[87936,90213],[43164,96425],[25655,38211],[66342,80739],[51698,83649],[21193,53658],[33933,61380],[14182,21811],[16522,91169],[1728,87892],[74266,97558],[17893,51548],[25851,60817],[14494,51897],[50525,85090],[22669,58152],[44409,66990],[3794,49977],[5277,34443],[52348,97511],[13905,85628],[54890,65885],[43297,74882],[5052,44756],[10316,52320],[21518,47442],[5009,67055],[38401,50928],[29044,64362],[29339,70949],[53328,67323],[33137,56168],[28375,76412],[311,92770],[43103,82585],[11679,90690],[45085,60658],[29110,38817],[46608,54899],[20284,53205],[9297,73669],[17662,83544],[57611,72664],[19126,85695],[9071,42050],[11544,58435],[70348,91673],[51018,68453],[17827,76864],[43351,54109],[64703,82115],[81944,86899],[38466,99980],[59117,70129],[37879,67364],[61289,75719],[50217,83464],[70000,88167],[9120,81261],[39409,91612],[31960,38295],[39271,57317],[20422,55615],[90030,94847],[5323,64911],[76366,92981],[59799,67793],[16371,88700],[6733,47897],[27382,29688],[10385,45886],[94394,96382],[21979,37051],[55334,97015],[22772,74050],[9020,56043],[28822,65217],[41274,53542],[51066,75084],[79910,89314],[14320,45298],[3306,44734],[44994,56184],[39126,39356],[10278,26531],[74611,97594],[11826,40640],[44189,76632],[68678,97300],[32113,86562],[3538,8282],[4411,74641],[15709,51902],[3658,74284],[57218,88756],[35864,70152],[30547,73544],[9569,23729],[7893,25903],[2960,98115],[1689,34329],[89996,91400],[12451,55990],[39241,61731],[15817,21167],[62503,72388],[60303,61630],[14017,69407],[48263,58406],[62321,80761],[83674,87760],[60974,72961],[9945,94092],[12467,68855],[26813,76057],[61675,95799],[14382,68703],[52128,76247],[22814,54107],[50616,54118],[18362,85301],[35456,44139],[17228,77045],[9366,10076],[27029,74909],[11287,86327],[81575,90875],[18828,95185],[20559,58469],[77505,87069],[45175,96638],[71194,96868],[61127,82609],[20306,99169],[18605,37017],[37831,78943],[2045,23015],[46484,63530],[50376,60722],[172,69120],[9473,81085],[42099,89454],[452,23821],[30648,55053],[8550,17365],[25928,62588],[3293,28820],[20571,80438],[25016,73349],[37271,93732],[20499,76926],[96625,97867],[7871,96359],[53527,58941],[23707,83934],[23226,39096],[66355,83423],[18808,97280],[11607,24407],[63044,82111],[11591,47795],[54685,83990],[10731,52041],[11118,63460],[13296,96962],[1793,25658],[26463,52811],[54025,67786],[91794,93604],[54876,98216],[4248,63090],[10518,38359],[55269,80898],[60128,72126],[50904,68900],[64916,86505],[37361,98337],[27450,45423],[96811,99775],[7431,32656],[7837,82154],[20898,65746],[61341,73817],[54930,98767],[39268,94705],[82293,92059],[41639,51210],[47116,88537],[33652,79611],[35248,97445],[8806,37650],[44200,91768],[32830,80450],[25892,54357],[15869,51037],[39687,44111],[14151,97664],[67490,76382],[12041,85398],[70374,72566],[371,34325],[23657,68649],[52404,85161],[33121,46686],[62228,96430],[9804,92044],[61054,77150],[19530,57696],[26375,26416],[45009,55560],[28593,42133],[34069,34289],[64009,90268],[22878,80972],[67905,95736],[87533,93029],[22118,41827],[77082,86477],[76593,91728],[16590,34186],[9653,28296],[40447,53848],[36818,55380],[9230,12838],[2990,11306],[12945,86267],[81342,84564],[27965,86152],[57157,67276],[63924,84126],[40341,94054],[10181,26421],[49821,87985],[10367,74279],[10048,13605],[58264,64882],[9383,52809],[43746,82554],[58938,90467],[19989,99590],[20682,93617],[47507,51867],[23556,56854],[12010,25420],[71191,72326],[28913,39263],[61806,67373],[4617,74841],[60248,69703],[46483,94028],[58302,98881],[53154,88596],[90428,98677],[48867,75090],[3961,78543],[48199,87610],[18304,86776],[334,98137],[70541,96547],[41647,93461],[1527,34672],[32797,74120],[55383,56375],[15742,34668],[65559,78604],[42014,56355],[20141,71281],[54298,99077],[24771,76665],[20068,71780],[6460,47895],[20928,75863],[27731,36914],[13861,87815],[23163,65672],[36176,50304],[37399,85535],[7879,97400],[41625,63973],[92583,97420],[24046,69317],[59018,80253],[33091,63586],[26407,38221],[9095,81510],[44007,61792],[11696,30091],[18584,55285],[13106,53737],[86598,88507],[615,24094],[75191,99467],[65709,99195],[9025,26227],[15064,46730],[998,90728],[39765,83859],[16764,69299],[18565,31622],[728,8989],[5397,22141],[20437,66849],[24359,91208],[53998,60016],[70425,81006],[20223,91837],[54163,97956],[17628,24583],[5858,94784],[33989,82818],[6365,85094],[49021,67010],[32301,42590],[37949,95908],[98553,98597],[49284,72369],[35835,53475],[10975,73060],[44818,62558],[389,84411],[28493,78940],[37190,94497],[6814,8990],[59994,91769],[5560,47226],[16592,25205],[45449,47380],[38490,92264],[83411,98399],[65501,93494],[9719,84096],[30857,62829],[1136,27321],[50440,58338],[58,41342],[12421,38155],[6256,9506],[80640,92109],[31790,60358],[40130,71028],[61494,67495],[15842,47891],[6783,55825],[39014,81505],[28726,85027],[26934,96002],[23490,36156],[25536,99971],[24290,98418],[75636,97420],[6200,45441],[3452,25391],[9910,32399],[632,67158],[21438,74621],[12663,38089],[7637,25343],[27443,27749],[700,67347],[2841,36312],[28887,96003],[16246,98579],[6382,42634],[59010,66950],[23371,43883],[15354,62732],[40474,99797],[20107,93989],[8760,66845],[1673,66258],[24629,70346],[24766,97267],[6861,45978],[28171,77806],[18128,37720],[23961,30915],[70190,86803],[4838,96293],[26179,55504],[46028,71691],[44227,57861],[30181,42186],[28323,54161],[8047,79114],[35907,67693],[50087,87300],[6928,96868],[13333,39538],[37182,55528],[53418,53603],[59099,72703],[93639,98968],[3431,16516],[70846,94771],[66952,82127],[56780,61597],[5495,67285],[34076,44778],[47820,89828],[7410,54459],[6803,53572],[53705,66061],[22386,35898],[41716,75964],[15872,66007],[40125,93238],[63111,79665],[10278,16160],[10459,93534],[92762,94498],[40941,73171],[56864,76321],[1607,89516],[6719,88423],[26053,56190],[6910,72621],[1682,61990],[3323,74736],[2710,90150],[41340,46520],[67885,69997],[1726,15809],[49499,81487],[1786,50489],[19428,51941],[19493,87714],[56752,97312],[28566,49846],[25408,34157],[60342,96932],[2785,79690],[1626,83118],[38434,78527],[75840,96787],[9737,23808],[15969,25999],[11979,68059],[7685,69837],[16890,26505],[86242,88786],[51856,56115],[940,18660],[42569,50704],[85206,85342],[67192,82941],[41514,49452],[14686,18225],[18419,87030],[3172,55526],[31013,94984],[32703,86820],[33982,54235],[14431,27872],[18126,35686],[54521,80956],[34147,96060],[965,90392],[19770,72740],[78555,86423],[64730,67049],[88009,88281],[78043,91538],[36980,42487],[31507,42616],[2956,56002],[75526,76638],[20386,85661],[23545,86109],[27282,79479],[38243,46013],[5966,29776],[36499,98161],[33992,95364],[18254,69162],[24984,98104],[20489,86238],[27273,40672],[20324,61884],[10335,13222],[17146,62127],[53028,73412],[18127,80585],[47168,67074],[27599,64962],[38128,62709],[10755,91536],[63124,96930],[1286,96247],[39618,93290],[8875,41789],[35300,44083],[2567,54346],[12738,53816],[16504,57661],[3475,40228],[52635,98571],[29747,48017],[72034,84882],[1976,8299],[18496,53868],[1550,64869],[1161,37423],[23035,74620],[82824,95080],[9625,60191],[3005,74423],[38625,90966],[50679,68996],[36969,86878],[35411,43553],[9317,95529],[22334,22836],[65207,86397],[19106,79893],[25491,90618],[28243,82928],[28411,62976],[4580,76227],[18749,74086],[74989,76764],[31213,76653],[79446,98283],[55138,91909],[79680,80079],[21745,87433],[4843,43132],[27748,38152],[9878,46241],[34596,51479],[64951,80636],[14846,83695],[15052,83625],[1960,43135],[5861,46521],[13000,34945],[19441,41969],[10216,95961],[35588,38449],[47983,88484],[19067,81806],[35520,77503],[8942,72449],[15086,26320],[14023,39197]], 7),
    ])
def test_removeCoveredIntervals(sut, intervals, answer):
    assert answer == sut.removeCoveredIntervals(intervals)


@pytest.mark.skip
def test_CombinationIterator_1():
    obj = CombinationIterator("abc", 2)
    assert obj.next() == "ab"
    assert obj.hasNext()
    assert obj.next() == "ac"
    assert obj.hasNext()
    assert obj.next() == "bc"
    assert not obj.hasNext()

@pytest.mark.skip
def test_CombinationIterator_1():
    obj = CombinationIterator("fiklnuy", 3)
    assert obj.next() == "fik"
    assert obj.hasNext()
    assert obj.next() == "fil"
    assert obj.hasNext()
    assert obj.next() == "fin"
    assert obj.hasNext()
    while True:
        print(obj.next())
        if not obj.hasNext():
            break

